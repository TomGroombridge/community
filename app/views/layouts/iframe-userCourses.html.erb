<!DOCTYPE html>
<html>
  <head>
    <title>CommunityMarketplace</title>
    <%= stylesheet_link_tag    "application", media: "all", "data-turbolinks-track" => true %>
    <%= javascript_include_tag "https://js.stripe.com/v1/", "application", "data-turbolinks-track" => true %>
  	<%= tag :meta, :name => "stripe-key", :content => Rails.application.secrets.stripe_public_key %>
    <%= csrf_meta_tags %>
    <link href='https://fonts.googleapis.com/css?family=Lato:300,400' rel='stylesheet' type='text/css'>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  </head>
  <body style="min-width: 100%;">
  	<div class="ui grid course-date-user">
  		<div class="three wide column title center">Date</div>
  		<div class="four wide column title center top">Time</div>
  		<div class="six wide column title">Title</div>
  		<div class="three wide column title center top">Actions</div>
  		<% @user.courses.each do |course| %>
  			<% course.upcoming_dates.each do |date| %>
			    <div class="three wide column">
						<div class="ui segment info center">
						  <i class="calendar icon"></i>
						  <%= date.start_date.strftime("%d/%m/%Y") %>
						</div>
			    </div>
			    <div class="four wide column top">
			    	<div class="ui segment info center">
			    		<i class="wait icon"></i>
			    		<%= date.start_time.strftime("%l:%M %p") %> - <%= date.end_time.strftime("%l:%M %p") %>
						</div>
			    </div>
			    <div class="six wide column">
			    	<div class="ui segment info">
						  <%= date.course.name %>
						</div>
			    </div>
			    <div class="three wide column top center actions">
						<%= link_to "Book Date", new_payment_path(:id => date.id), :class => "ui blue button", :target => "_blank"%>
						<i class="info circle icon" id="flip-<%= date.id %>"></i>
			    </div>
			    <div id="panel-<%= date.id %>" class="ui segment panel">
			    	<h3> Description</h3>
			    	<%= course.description.truncate(300).html_safe %>
			    	<br>
			    	<%= link_to "View More Details...", course_path(date.course), :class => "ui blue button", :target => "_blank" %>
			    </div>
			  	<script>
						$(document).ready(function(){
						    $("#flip-<%= date.id %>").click(function(){
						        $("#panel-<%= date.id %>").slideToggle("slow", function() {
									    // $("#flip-<%= date.id %>").text($(this).is(':visible') ? "Hide" : "Show");
									  });
						    });
						});
					</script>
					<style>
						#panel-<%= date.id %>{
						  padding: 50px;
						  display: none;
						  font-size: 15px;
						  margin-top: -3px;
						  margin-left: 14px;
						  margin-right: 14px;
						  padding-top: 10px;
						  padding-bottom: 15px;
						}
					</style>
		    <% end %>
		  <% end %>
  	</div>
  </body>
</html>